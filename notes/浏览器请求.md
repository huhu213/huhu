#浏览器请求

##请求过程

* 用户键入URl
* 解析IP地址

> 1. 浏览器DNS缓存，没找到2，找到到4
> 2. 系统DNS缓存，没找到3，找到4
> 3. 系统发起DNS服务请求
> 4. 得到URL对应的IP地址

* 客户端以端口(1024-65535)像服务器端口(默认80)发起三次握手请求
* 链接成功，发起http请求，请求包括请求行、请求头、空行以及请求数据
* 服务器接收到请求，返回http请求数据
* 浏览器解析HTML文件
* 加载外部脚本和样式文件
* 解析并执行脚本代码
* 构造HTML DOM文档对象模型
* 加载图片等外部文件(通常浏览器对图片等静态资源有缓存)

###请求中遵循的协议
DNS协议：应用层协议，用于请求域名对应的IP地址
TCP协议：传输层，构建端到端的面向连接的可靠连接
IP协议：网络层，不可靠
HTTP协议：应用层协议，默认端口号80，若基于SSL或者TSL协议，变为更可靠的HTTPS协议，默认端口号403

###http协议

* **请求行**：请求方法 URL 协议版本，主要方法有POST、GET、DELETE、PUT、HEAD等；GET方法中，数据放在URL后面，HTTP协议本身对URl长度没有限制，但浏览器和服务器有大小限制，IE限制2083个字符，chrome限制8182个字符；POST方法将数据放在请求的数据部分，以键值对的方法存储，可以大量传输数据
* **请求头**：通知服务器关于请求的信息，典型的有User-Agent(产生请求的浏览器的类型)，Accept(客户端可识别的内容类型列表)、Host(请求的主机名，允许多个域名处于同一个IP，即虚拟主机)、Connection: keep-alive(表示保持当前连接，可以请求相同服务器的多个资源)、is-Modified-Since：自从XXX服务器端是否修改过数据，若未修改服务器返回304码，读取本地缓存，否则重新读取请求数据

>
>  IE浏览器对get请求进行缓存，当请求没有变化时，直接读取本地缓存结果，而不是重新发起请求；只有使用相同的URL重复GET请求会返回预期相同的结果时，GET方法才是高效的；浏览器对POST请求不进行缓存。


* **空行**：表示请求头结束
* **请求数据**：适用于表单信息请求，与请求数据相关的最常使用的请求头是Content-Type和Content-Length

###状态码
3XX: 重定向
4XX: 客户端错误
404: 请求的URl不存在
5XX: 服务器端错误
500: 服务器内部错误
501: Bad Gateway，代理服务器联系不到后端服务器
502: Gateway Timeout


##浏览器请求并发限制
[blog](http://sgdev-blog.blogspot.com/2014/01/maximum-concurrent-connection-to-same.html)

一般来说，浏览器并发执行的http请求个数是有限制的，大多数浏览器这个阈值在8. 虽然提高并发限制阈值能提高加载速度，但是当小部分浏览器集中并发请求过多时，可能会导致服务器过载，从而被服务器当做DDOS攻击。

HTTP/1.1协议建议，一个主机名(hostname)下浏览器并发执行两个http请求。即，浏览器的并发是相对于域名(主机名)而言的。通过hash、CNAMEs(DNS aliases)等方式可以通过多域名来实现并发请求。






